#!/bin/bash

# @PACKAGE@-@VERSION@ (@DESCRIPTION@) #

# Copyright (C) 2014 Antonio Cao (@burzumishi) #

# This is free software; 
# You have unlimited permission to copy and/or distribute it,
# with or without modifications, as long as this notice is preserved.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.


# @PACKAGE@ @VERSION@ (@DESCRIPTION@) #
# Usage: xenesis <plugin_name> <host>||<host_list> <plugin_params (optional)>


# Load Configuration Files #

# Import @PACKAGE@ Main Config File #
. @sysconfdir@/@PACKAGE@/@PACKAGE@.conf;

# Import @PACKAGE@ Dinamic Config Files (conf.d) #
if [ -d "@sysconfdir@/@PACKAGE@/conf.d" ]; then
        CONFD=$(find @sysconfdir@/@PACKAGE@/conf.d -iname "*.conf");
        for confd in $CONFD; do
                . $confd;
        done
fi;


# Load Libraries #

# Import @PACKAGE@ Core Functions #
. @libdir@/libxenesis.so;

# Import @PACKAGE@ Remote Admin Layer (RAL) Functions #
. @libdir@/libxenesis-ral.so;


# Start @PACKAGE@ # libxenesis.so #

# Check @PACKAGE@ runtime directory structure # 
check_directory_structure "$LOGDIR" "$PLUGINSDIR" "$HOSTSDIR";

# @PACKAGE@ startmsg #
startmsg;

# @PACKAGE@ check current user #
check_user;

# @PACKAGE@ Read User Input Options #
case $1 in
'exec') start_ral $2 $3 $4; # Start RAL #
	;;
'test') start_ral_test $2 $3 $4; # Start RAL #
	;;
*) 		usage; # @PACKAGE@ HELP #
	;;
esac

exit;
